---
import { Authors, Cache, DateFormatter, Posts, UrlFormatter } from 'astro-accelerator-utils';
import type { Frontmatter } from 'astro-accelerator-utils/types/Frontmatter';
import { SITE } from '@config';
import { Translations, Lang } from '@util/Languages';;

// Properties
type Props = {
  lang: string;
  frontmatter: Frontmatter;
};
const { lang, frontmatter } = Astro.props as Props;

// Language
const _ = Lang(lang);

// Logic
const cache = new Cache(SITE.cacheMaxAge);
const posts = new Posts(cache);
const authors = new Authors(posts);
const dateFormatter = new DateFormatter(SITE.dateOptions);

const authorList = authors.forPost(frontmatter);
---
{authorList.writers.length > 0 && 
<div class="post-meta">
  <div class="author-info">
    <span>{ _(Translations.post.written_by) }
      {authorList.writers.map((writer) => (
        <span>{ writer.frontmatter.title }</span>
      ))}.<br />
      <time datetime={ frontmatter.pubDate.toString() }>
      { dateFormatter.formatDate(frontmatter.pubDate, lang) }
      </time>
    </span>
  </div>
</div>
}
